<aura:component controller="FindRoutes" implements="force:hasRecordId, lightning:actionOverride, force:lightningQuickAction">

    <aura:attribute name="recordId" type="String"/>
    <aura:attribute name="Schedule" type="Schedule__c"/>
    <aura:attribute name="Columns" type="List"/>
    <aura:attribute name="maxRowsSelection" type="Integer" default="5"/>
    <aura:attribute name="scheduleStartDate" type="Date"/>
    <aura:attribute name="scheduleEndDate" type="Date"/>
    <aura:attribute name="arrivalPort" type="String"/>
    <aura:attribute name="departurePort" type="String"/>
    <aura:attribute name="isTableReady" type="Boolean" default="false"/>
    <aura:attribute name="isScheduleSelected" type="Boolean" default="false"/>
    <aura:attribute name="selectedSchedule" type="String"/>

    <!-- Enter dates & ports to look for a schedule -->
    <lightning:card title="Schedule a Booking">
        <lightning:input type="date" label="Date of Departure" value="{!v.scheduleStartDate}"/>
        <lightning:input type="date" label="Date of Arrival" value="{!v.scheduleEndDate}" />

        <lightning:recordEditForm objectApiName="Route__c">
        <lightning:inputField fieldName="Port_of_Origin__c" value="{!v.departurePort}"/>
        <lightning:inputField fieldName="Port_of_Destination__c" value="{!v.arrivalPort}"/>
        </lightning:recordEditForm>

        <lightning:button label="Search" title="Search for Schedules" onclick="{!c.getSchedule}"/>
    </lightning:card>

    <!-- check if boolean isTrue and then draw table -->
    <aura:if isTrue="{!v.isTableReady}">
        <lightning:datatable data="{!v.Schedule}" onrowselection="{!c.onSelectedSchedule}" columns="{!v.Columns }" keyField="Id"  maxRowSelection="{!v.maxRowSelection}"/>

    <!-- check if another boolean isTrue and then allow user to enter further info -->
        <aura:if isTrue="{!v.isScheduleSelected}">
            <lightning:card title="Provide booking details">
                <lightning:recordEditForm objectApiName="Schedule_booking__c" onsubmit="{!c.createBooking}">

                    <lightning:inputField fieldName="Type_of_goods__c"/>
                    <lightning:inputField fieldName="Declared_Teu__c"/>
                    <lightning:inputField fieldName="Opportunity__c" value="{!v.recordId}" class="slds-hidden"/>
                    <lightning:inputField fieldName="Schedule__c" value="{!v.selectedSchedule}" class="slds-hidden"/>

                    <lightning:button type="submit" label="Create Booking"/>
                </lightning:recordEditForm>
            </lightning:card>
        </aura:if>
    </aura:if>


</aura:component>
